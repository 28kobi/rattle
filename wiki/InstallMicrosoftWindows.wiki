#summary Install Rattle on Microsoft Windows 32 bit or 64bit.

This is known to work on Microsoft Windows 32bit and 64bit versions XP, Vista and 7.

= Steps =

== Install GTK+ ===

GTK+ is used for the Rattle graphical user interface (GUI). It is a separate package to R itself. Two alternatives are available. The first is simpler but works only for 32bit. The second is recommended, but a little more complex.

  * Download and run the self installing package for GTK+ (2.22.0 is 7.8MB) from [http://downloads.sourceforge.net/gtk-win/gtk2-runtime-2.22.0-2010-10-21-ash.exe Sourceforge].

*or*

  * Download either or both versions of GTK+ 
      * http://ftp.gnome.org/pub/gnome/binaries/win32/gtk+/2.22/gtk+-bundle_2.22.0-20101016_win32.zip
      * http://ftp.gnome.org/pub/gnome/binaries/win64/gtk+/2.22/gtk+-bundle_2.22.0-20101016_win64.zip

  * Extract the zip archive into, for example, c:\gtkwin32 (or c:\gtkwin64 as appropriate).

  * Edit your system's PATH environment variable to add c:\gtkwin32\bin. The PATH can be editted on Windows 7 by choosing Properites from the right mouse button menu on Computer under the Windows menu. Then choose "Advanced system settings" and then "Environment Variables". Edit "PATH" under "System variables."

== Install R and Rattle ==

  * Download and install R (2.12.0 is 37MB) from [http://cran.r-project.org/bin/windows/base/R-2.12.0-win.exe CRAN], the Comprehensive R Archive Network. Choosing all the defaults on the install works just fine.

  * Install Rattle by opening the R Desktop icon and enter the following command at the R prompt. R asks us to nominate a CRAN mirror. Choose a nearby location.
{{{
> install.packages("rattle")
}}}

  * Start Rattle by opening the R Desktop icon and then enter the following two commands at the R prompt. First load the Rattle package into the library and the start up Rattle:
{{{
> library(rattle)
> rattle()
}}}

= Options =

  * To use the MS-Windows theme engine, and thus have rattle look like all other Windows applications (in terms of colour and style), create a file c:\gtkwin32\etc\gtk-2.0\gtkrc to contain the following line. Make sure the file name does not have any filename extension (i.e., no .txt or anything else with a dot)
{{{
    gtk-theme-name = "MS-Windows"
}}}


  * We can install other packages Rattle uses. Rattle will notice these packages missing when we try to use some functionality dependent on the package. If so, then Rattle will offer to install them. However, we can install them all now if we might not always be connected to the Internet. We might need to restart R to be able to reinstall Rattle. 
{{{
> install.packages("rattle", dep=c("Suggests"))
}}}

  * Download and install GGobi (2.1.8 is 807KB) from http://www.ggobi.org/downloads/ as [http://www.ggobi.org/downloads/ggobi-2.1.8.exe ggobi-2.1.8.exe]. On Windows 7 32bit I also had to manually install the libxml2 and iconv binary libraries from http://xmlsoft.org/sources/win32/. These libraries are included in the older sourceforge package but not the gtk.org package. There is currently (November 2010) no 64bit version for Windows.

  * You may like to install Emacs Speaks S, a comprehensive environment for writing R code on MS/Windows. Download and install the latest version available (47.5MB) from http://vgoulet.act.ulaval.ca/en/ressources/emacs/windows as [http://vgoulet.act.ulaval.ca/pub/emacs/emacs-23.2-modified-8.exe emacs-23.2-modified-8.exe].

  * Alternatively, you may like to install Tinn-R - a more traditional GUI based IDE for R (4.3MB) from http://sourceforge.net/projects/tinn-r as [http://downloads.sourceforge.net/project/tinn-r/Tinn-R%20setup/2.3.7.1/Tinn-R_2.3.7.1_setup.exe Tinn-R_2.3.7.1_setup.exe]

= Issues =

== GTK Appears to be Missing ==

This is characterised by a popup on starting `rattle()` indicating the the GTK libraries are missing and asking whether you would like to install them (actually the popup comes from loading the `RGtk2` package). If you have already installed GTK as above, we should not be seeing this message. Choose not to install and then exit from R. Now, you probably have the wrong or multiple versions of the GTK libraries installed. You need to find them all and remove each one. Then just install the latest GTK as identified above.

== zlib1.dll ==

The new version of the RGtk2 package uses a call to a new procedure in the zlib1.dll library. The version of this library that is supplied by the XML package from R is older. Thus you may see a message of the form: `The procedure entry point deflateSetHeader could not be located in the dynamic link library zlib1.dll.` With a fresh install on Windows I believe this does not happen. If it does, one solution is to search for and remove zlib1.dll from the installed XML package.

== Missing libatk-1.0-0.dll ==

This indicates that GTK+ has not been installed or perhaps multiple versions have been installed. The best solution seems to be to remove all installations of GTK that you can find, and reinstall as above.

== Entry point cairo_glyph_allocate not located in libcairo-2.dll ==

You probably have an older version of GTK+ installed (perhaps in addition to the newer version). Remove all GTK+ installs and just install as above.

== Entry point not located: cairo_clip_extents ==

Fionn Hope reported 20 November 2010 the following error: `The procedure entry point cairo_clip_extents could not be located in the dynamic link library libcairo-2.dll.` Once the GGobi package was removed the error went away.
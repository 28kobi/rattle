## Gnome R Data Miner: GNOME interface to R for Data Mining
##
## Time-stamp: <2006-12-08 12:32:40 Graham>
##
## Textview widget support
##
## Copyright (c) 2006 Graham Williams, Togaware.com, GPL Version 2

setTextview <- function(tv, ..., sep="")
{
  msg <- paste(sep=sep, ...)
  if (length(msg) == 0) msg <-""
  theWidget(tv)$getBuffer()$setText(msg)
}

addTextview <- function(tv, ..., sep="")
{
  msg <- paste(sep=sep, ...)
  if (length(msg) == 0) msg <-""
  tv.buf <- theWidget(tv)$getBuffer()
  loc <- tv.buf$getEndIter()$iter
  tv.buf$insert(loc, msg)
}
  
textviewSeparator <- function()
{
  return(paste(sprintf("\n\nGenerated by Rattle %s %s\n", Sys.time(),
                       Sys.info()["user"]),
               paste(rep("=", 70), collapse=""), "\n", sep=""))
}

clearTextview <- function(tv)
{
  theWidget(tv)$modifyFont(pangoFontDescriptionFromString("monospace 10"))
  theWidget(tv)$getBuffer()$setText("")
}

appendTextview <- function(tv, ..., sep="")
{
  msg <- paste(sep=sep, ...)
  if (length(msg) == 0)
    msg <-""
  else
    msg <- paste(msg, sprintf("\n\nGenerated by Rattle %s %s\n",
                              Sys.time(), Sys.info()["user"]),
                 paste(rep("=", 70), collapse=""), "\n", sep="")
  tv.buf <- theWidget(tv)$getBuffer()
  location <- tv.buf$getEndIter()$iter
  tv.buf$insert(location, msg)
}

getTextviewContent <- function(TV)
{
  ## Extract text contents of specified textview and return
  ## it. Designed for use in saveProject.
  
  log.buf <- theWidget(TV)$getBuffer()
  start <- log.buf$getStartIter()$iter
  end <- log.buf$getEndIter()$iter
  return(log.buf$getText(start, end))
}

setTextviewContents <- function(TV, text)
{
  ## Set the text contents of the specified textview to the supplied
  ## text. Designed for use in loadProject.

  clearTextview(TV)
  theWidget(TV)$setWrapMode("none")
  if (is.null(text))
    theWidget(TV)$getBuffer()$setText("")
  else
    theWidget(TV)$getBuffer()$setText(text)
}
